{% extends 'base.html' %}
{% block title %}{{ _('Configuraci贸n - SafeSpace') }}{% endblock %}
{% block content %}

  <div class="settings-card card">
    <h2>{{ _('Configuraci贸n') }}</h2>

    <!-- Secci贸n de idioma -->
    <div class="settings-section">
      <h3>{{ _('Idioma') }}</h3>
      <p>{{ _('Selecciona tu idioma preferido:') }}</p>
      <select id="settings-lang-select" class="lang-select">
        <option value="es"> Espa帽ol</option>
        <option value="en">吼 English</option>
        <option value="pt_BR">ю Portugu锚s</option>
        <option value="pt">叼 Portugu锚s (PT)</option>
        <option value="de"> Deutsch</option>
        <option value="fr"> Fran莽ais</option>
        <option value="it"> Italiano</option>
      </select>
    </div>

    <!-- Secci贸n de tema (modo oscuro) -->
    <div class="settings-section">
      <h3>{{ _('Tema') }}</h3>
      <div class="settings-item">
        <label for="themeToggle">{{ _('Modo oscuro') }}</label>
        <label class="switch">
          <input type="checkbox" id="themeToggle">
          <span class="slider"></span>
        </label>
      </div>
    </div>

    <!-- Secci贸n de informaci贸n de la app -->
    <div class="settings-section">
      <h3>{{ _('Informaci贸n de la app') }}</h3>
      <p>{{ _('SafeSpace es una red social de apoyo emocional que te permite compartir tus emociones, conectarte con amigos y encontrar ayuda en momentos dif铆ciles.') }}</p>
      <p>{{ _('Versi贸n') }} 3.0</p>
    </div>

    <!-- Secci贸n de legales -->
    <div class="settings-section">
      <h3>{{ _('Legales') }}</h3>
      <ul class="settings-links">
        <li><a href="{{ url_for('legales.terms') }}">{{ _('T茅rminos y Condiciones') }}</a></li>
        <li><a href="{{ url_for('legales.privacy') }}">{{ _('Pol铆tica de Privacidad') }}</a></li>
      </ul>
    </div>

    <!-- Acci贸n cerrar sesi贸n -->
    <div class="settings-section">
      <form action="{{ url_for('auth.logout') }}" method="GET">
        <button type="submit" class="logout-btn">{{ _('Cerrar sesi贸n') }}</button>
      </form>
    </div>
  </div>

{% endblock %}

{% block scripts %}
  {{ super() }}
  <script>
  document.addEventListener('DOMContentLoaded', function() {
    // Inicializar selector de idioma con el idioma actual
    const langSelect = document.getElementById('settings-lang-select');
    if (langSelect) {
      langSelect.value = '{{ g.get('lang', 'es') }}';
      langSelect.addEventListener('change', function() {
        const lang = this.value;
        // Redirige al endpoint que guarda la cookie y recarga la p谩gina
        window.location.href = `/set_language/${lang}`;
      });
    }
    // Sincronizar el estado del modo oscuro con localStorage
    const themeToggle = document.getElementById('themeToggle');
    if (themeToggle) {
      const isDark = localStorage.getItem('darkMode') === 'on';
      themeToggle.checked = isDark;
      themeToggle.addEventListener('change', function() {
        // Utiliza la funci贸n global de main.js para aplicar la preferencia
        if (typeof window.applyDarkMode === 'function') {
          window.applyDarkMode(this.checked);
        }
      });
    }
  });
  </script>
{% endblock %}