{% extends 'base.html' %}
{% block title %}{{ _('Inicio - SafeSpace') }}{% endblock %}
{% block content %}

    <div class="card home-card">
      <h2>{{ _('Bienvenido, %(username)s', username=user.username) }}</h2>
      <p>{{ _('Gracias por unirte a SafeSpace. Navega utilizando el men√∫ de la izquierda.') }}</p>
    
  </div>

  <!-- üîß Service Worker + PWA -->
  <script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register("{{ url_for('static', filename='service-worker.js') }}")
        .then(function(reg) {
          console.log("‚úÖ Service Worker registrado con √©xito:", reg.scope);
        })
        .catch(function(error) {
          console.error("‚ùå Error al registrar el Service Worker:", error);
        });
    }

    let deferredPrompt;
    const installBtn = document.getElementById('install-btn');

    window.addEventListener('beforeinstallprompt', (e) => {
      e.preventDefault();
      deferredPrompt = e;
      installBtn.style.display = 'block';

      installBtn.addEventListener('click', async () => {
        installBtn.style.display = 'none';
        deferredPrompt.prompt();
        const choiceResult = await deferredPrompt.userChoice;
        console.log("‚úÖ Instalaci√≥n:", choiceResult.outcome);
        deferredPrompt = null;
      });
    });
  </script>
{% endblock %}
