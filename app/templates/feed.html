{% extends 'base.html' %}
{% block title %}{{ _('ðŸ“° Feed - SafeSpace') }}{% endblock %}
{% block content %}

    <div class="card feed-card">
        <h2>{{ _('ðŸ“° Publicaciones recientes') }}</h2>

        <!-- Historias/estados en la parte superior del feed -->
        <div class="stories-row">
          <!-- BotÃ³n para crear un nuevo estado -->
          <div class="story-item create-story">
            <div class="story-avatar">+</div>
            <div class="story-label">{{ _('Crear estado') }}</div>
          </div>
          <!-- Mostrar algunos usuarios como ejemplo de historias existentes -->
          {% for post in publicaciones[:6] %}
            <div class="story-item">
              <div class="story-avatar">
                {% if post.author.profile_picture and 'http' in post.author.profile_picture %}
                  <img src="{{ post.author.profile_picture }}" alt="{{ _('Foto de perfil') }}" />
                {% else %}
                  <img src="{{ url_for('static', filename='profile_pics/' + (post.author.profile_picture or 'default.png')) }}" alt="{{ _('Foto de perfil') }}" />
                {% endif %}
              </div>
              <div class="story-label">{{ post.author.username }}</div>
            </div>
          {% endfor %}
        </div>

        <div class="feed-list">
        {% for post in publicaciones %}
          <div class="post-card">
            <div class="post-header">
              <img class="profile-pic"
                src="{% if post.author.profile_picture and 'http' in post.author.profile_picture %}
                       {{ post.author.profile_picture }}
                     {% else %}
                       {{ url_for('static', filename='profile_pics/' + (post.author.profile_picture or 'default.png')) }}
                     {% endif %}"
                alt="{{ _('Foto de perfil') }}"
              />
              <div>
                <div class="post-user">{{ post.author.username }}</div>
                <div class="post-date">{{ post.timestamp.strftime('%d/%m/%Y %H:%M') }}</div>
              </div>
            </div>
            <div class="post-content">
              {{ post.content }}
            </div>
            {% if post.image_url %}
              <img class="post-image" src="{{ post.image_url }}" alt="{{ _('Imagen de publicaciÃ³n') }}">
            {% endif %}
          </div>
        {% else %}
          <div class="feed-empty">{{ _('No hay publicaciones todavÃ­a.') }}</div>
        {% endfor %}
        </div>
    </div>
  
{% endblock %}
